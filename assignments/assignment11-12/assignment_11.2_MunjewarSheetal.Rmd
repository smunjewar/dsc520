---
html_document: default
author: "Sheetal M"
date: "`r Sys.Date()`"
output:
  pdf_document: default
  html_document:
    df_print: paged
title: "assignment_11.2_MunjewarSheetal"
word_document: default
link-citations: yes
---

## Install and Load required packages :
```{r }
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(fig.width = 12, fig.height = 10)
knitr::opts_chunk$set(tidy.opts = list(width.cutoff = 70), tidy = TRUE)

# Package names
# packages <- c("ggplot2","dplyr","tidyr","magrittr","tidyverse","purrr","tidy")
packages <- c("broom","dplyr","RWeka","class","ggplot2","caret","formatR")

# Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
  install.packages(packages[!installed_packages])
}

# Packages loading
invisible(lapply(packages, library, character.only = TRUE))

k_values <- list(3, 5, 10, 15, 20, 25)
knitr::opts_chunk$set(echo = TRUE)

```

## KNN - Nearest neighbors algorithm for binary and trinary classifiers

## Set the working directory to the root of your DSC 520 directory
setwd("E:\\Data_Science_DSC510\\DSC520-Statistics\\dsc520") 

``` {r load binary and trinary dataset into the data famres }

# Set the working directory to the root of your DSC 520 directory
setwd("E:\\Data_Science_DSC510\\DSC520-Statistics\\dsc520") 

# Load data from data/binary-classifier-data.csv
df1 <- read.csv("data/binary-classifier-data.csv")
str(df1)
nrow(df1)

# Load data from data/trinary-classifier-data.csv
df2 <- read.csv("data/trinary-classifier-data.csv")
str(df2)
nrow(df2)

# distinct values with count in data frame column Label.
table(df1$label)
table(df2$label)

```
## Convert label column data type into factor 
```{r Factor Conversion}
df1$label <- as.factor(df1$label)
str(df1)

df2$label <- as.factor(df2$label)
str(df2)
```

## Visualize data 
```{r visualize the data for df1 and df2 }
# df1 plot
ggplot(data = df1, aes(x,y, color=factor(label))) + geom_point()
# df2 plot
ggplot(data = df2, aes(x,y, color=factor(label))) + geom_point()

```

## Fit the model for dataset-df1 and its accuracy
```{r df1 model fitting }
i=1
k.optm=1
for (i in k_values){
  knn.mod <- knn(train=df1, test=df1, cl=df1$label, k=i)
  #print(paste("Printing : ",knn.mod ))
  summary(knn.mod)
  k.optm[i] <- 100 * sum(df1$label == knn.mod)/NROW(df1)
  k=i
  cat(k,'=',k.optm[i],'')}

#k.optm
```
## Accuracy plot for dataset-df1
```{r Accuracy-df1}
plot(k.optm, type="b", xlab="K- Value",ylab="Accuracy level")
```
### The above graph shows that for ‘K’ value of 3(98.59813) we get the maximum accuracy.

## Fit the model for dataset-df2 and its accuracy
```{r df2 model fitting}
i=1
k.optm=1
for (i in k_values){
  knn.mod <- knn(train=df2, test=df2, cl=df2$label, k=i)
  #print(paste("Printing : ",knn.mod ))
  summary(knn.mod)
  k.optm[i] <- 100 * sum(df2$label == knn.mod)/NROW(df2)
  k=i
  cat(k,'=',k.optm[i],'')}

#k.optm
```

## Accuracy plot for dataset-df2
```{r Accuracy-df2}
plot(k.optm, type="b", xlab="K- Value",ylab="Accuracy level")
```
### The above graph shows that for ‘K’ value of 3 (97.57653) we get the maximum accuracy.

## Linear classifiers.
Visuals for both datasets df1 and df2 are scattered in small clusters ( reference - scatter plot drawn for df1 and df2), cannot be classified in linear model to show relationship among variables by plotting straight line, hence linear model may not be right fit for this data sets.

