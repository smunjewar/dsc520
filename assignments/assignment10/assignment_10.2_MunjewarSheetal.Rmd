---
html_document: default
author: "Sheetal M"
date: "`r Sys.Date()`"
output:
  pdf_document: default
  html_document:
    df_print: paged
title: "assignment_10.2_MunjewarSheetal"
word_document: default
link-citations: yes
---

## Install and Load required packages :
```{r }
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(fig.width = 12, fig.height = 10)
knitr::opts_chunk$set(tidy.opts = list(width.cutoff = 70), tidy = TRUE)

# Package names
# packages <- c("ggplot2","dplyr","tidyr","magrittr","tidyverse","purrr")
packages <- c("broom","dplyr","RWeka","class","ggplot2")

# Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
  install.packages(packages[!installed_packages])
}

# Packages loading
invisible(lapply(packages, library, character.only = TRUE))

```

## Problem statement : Predict one year life expectancy of lung cancer patients post surgery.

## Set the working directory to the root of your DSC 520 directory
setwd("E:\\Data_Science_DSC510\\DSC520-Statistics\\dsc520") 

``` {r}

## Set the working directory to the root of your DSC 520 directory
setwd("E:\\Data_Science_DSC510\\DSC520-Statistics\\dsc520") 

## Load data from data/binary-classifier-data.csv
bc_data <- read.csv("data/binary-classifier-data.csv")
str(bc_data)
#nrow(pat_data)
```
## Convert label column data type into factor 
```{r Factor Conversion}
bc_data$label <- as.factor(bc_data$label)
str(bc_data)
```

## Visualize data
```{r visualize}
ggplot(data = bc_data, aes(x,y, color=factor(label))) + geom_point()
```

##  Generalized Linear Model 
```{r Generalized Linear Model}
bc_mod01 <- glm(label ~ ., data = bc_data, family = "binomial")
```

##  Model Summary 
```{r Model Summary}
summary(bc_mod01)
```

## Variables with significance
1. X is Most Significant

## Dataframe with new predicted column predict_Risk
```{r New prediction}

knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(fig.width = 12, fig.height = 10)
knitr::opts_chunk$set(tidy.opts = list(width.cutoff = 70), tidy = TRUE)

#mod_plus <- augment(pat_mod01, type type.predict="response")
#class(mod_plus)
bc_mod01_predict <- augment(bc_mod01, type.predict="response") %>% mutate(predict_Risk = round(.fitted))

# Name additional columns and check class.
# class(mod_plus)
# names(mod_plus)
# https://cyberactive.bellevue.edu/ultra/courses/_514803_1/cl/outline
# alternate options using predict function() - predict(bc_mod01, type = "response")
```

## Confusion matrix to calculate accurracy
```{r confusion}
bc_mod01_predict %>% select(label, predict_Risk) %>% table()
# Alternate option :
# predict <- predict(logit, data_test, type = 'response')
# table_mat <- table(data_test$income, predict > 0.5)

```

## c. Accuracy of the Model
accuracy = correctly predicted / total Predicted * 100

```{r Accuracy of the Model}

knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(fig.width = 12, fig.height = 10)
knitr::opts_chunk$set(tidy.opts = list(width.cutoff = 70), tidy = TRUE)


# Evaluating accuracy of Regression Models - https://www.youtube.com/watch?v=03FrK8d2QVQ
# Accuracy using confusion matric : https://towardsdatascience.com/confusion-matrix-for-your-multi-class-machine-learning-model-ff9aa3bf7826#:~:text=Accuracy%3A%20It%20gives%20you%20the,TN%2BFP%2BFN).

accuracy <- (429 + 445) / (429 + 338 + 286 + 445)
accuracy <- accuracy * 100
print(paste(round(accuracy), "%"))
```


